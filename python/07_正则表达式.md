# 正则表达式

> 正则表达式很有用，类似于设定一系列规则的模糊查找。

## 目标

* 熟悉正则表达式基本用法
* 熟悉正则表达式的使用场景
* 练习

## 01. IP地址案例
我们先来看一个例子：

```python
print('*****IP地址合法性判断程序*****')
ip=input("请输入ip地址：")
#判断是否有3个点
if ip.count(".")==3:
    for i in ip.split('.'):
        #判断输入是否是数字
        if i.isdecimal():
            #判断数字是否小于等于255
            if int(i)<=255:
                continue
            else:
                print("地址格式错误")
                break
        else:
            print("地址格式错误")
            break
    else:
        print('ip地址合法')
else:
    print("地址格式错误")
```
这个一个判断IPv4地址合法性的例子。

### 需求分析

- IPv4地址一定是由3个点组成
- 总共被3个点分成了4段，每段必须是数字
- 每段的数字必须小于255，大于0

### for else 用法
```python
for i in ip.split('.'):
    ...
else:
    print('ip地址合法')
```
- 当 for 循环正常完成每一轮循环，没有 break 打断循环的话，else 里的内容会运行。

### 思考一个问题：为什么在程序中不用判断数字是否大于0？

## 02. 使用正则表达式
> 当需要判断的规则复杂时，我们需要用许多的步骤才能完成任务，而正则表达式就是专门处理文本规则的工具。

```python
# 导入模块
import re

print('*****IP地址合法性判断程序*****')
ip=input("请输入ip地址：")

# 新建正则表达式规则的对象
comp = re.compile(r'^((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}')
# 使用输入的ip地址和正则表达式规则进行匹配
if(comp.fullmatch(ip)):
    print('ip地址合法')
else:
    print("地址格式错误")
```
- 正则表达式看起来非常复杂，理解起来并不容易
- 但大部分你平时使用的规则，在网上都是现成的，可以复制过来直接使用

### 0~255 的规则匹配
> 0~255 对应的正则表达式为 (2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2}

- 2(5[0-5]|[0-4]\d) 匹配：200 ~ 255
    - 2 表示 2 这个数字
    - \[ \] 表示在一定范围中取值
    - 5[0-5] 表示 50,51,52,53,54,55 这几种组合
    - | 表示或者
    - \d 表示0-9的数字
    - [0-4]\d 表示 00-49 的数字的组合
- [0-1]?\d{1,2} 匹配：0 ~ 199
    - ? 表示前面的内容可选
    - { } 表示前面规则重复的次数
    - {1,2} 表示前面的规则可以重复1次到2次，结合前面的规则，翻译出来就是\d\d?

### IPv4 地址的规则匹配
```python
r'^((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}'
```
- r 在字符串前面表示该字符串里的符号不用转义，保留原义
- ^ 代表从字符串的第一个字符开始，就要匹配规则，如果不用 ^ ，则1255也算合法的，因为255能匹配给定的规则
- ((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2}) 代表地址的第1段xxx，0-255之间的数字
- \. 表示每段的分隔点`.`，用的转义符表示
- (\.规则){3} 表示重复3次前面的规则，也就是地址的后3段的表示.xxx.xxx.xxx

### #小练习
在网上搜索3个不同的正则表达式规则

## 03. 其他常用方法
- match()：从字符串开头进行检查
```python
import re

#因为c没有出现在第一个位置，所以没有匹配规则
re.match("c", "abcdef")
```

- search()：从字符串任意位置进行检查

```python
import re

#c出现在任何位置都可以，匹配上了规则
re.search("c", "abcdef")
```
- 上面2个例子规则都是：一个子母`c` 

### #小练习
试试在一个字符串：

'Python 提供了两种不同的操作：基于 re.match() 检查字符串开头，或者 re.search() 检查字符串的任意位置'

中，使用正则表达式规则找到`检查`这个单词

## 04. 练习

完成超星学习通上的练习
